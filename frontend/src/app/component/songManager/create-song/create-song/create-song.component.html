<div class="page-title m-b">
  <h1 class="inline m-a-0" style="padding-left: 50px">Add New Song</h1>
</div>

<div class="container-fluid">
  <form (ngSubmit)="createSong()" [formGroup]="createMusicForm">
    <div class="row">

      <div class="col-md-4">
        <p></p>
      </div>
      <div class="col-md-2">
        <mat-form-field appearance="fill" class="example-full-width">
          <mat-label><strong style="color: darkgray;">Name Song: </strong></mat-label>
          <input type="text" matInput formControlName="nameSong" placeholder="Hello">
          <mat-error
            *ngIf="createMusicForm.get('nameSong').invalid && createMusicForm.get('nameSong').touched">
            Name Song is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </div>
      <div class="col-md-2">
        <div class="form-group">
          <label><strong>Image song: </strong></label> &nbsp;
          <label class="label-input" for="avatar">
            <div *ngIf="firebase.fileToUpload; else NoSelect">
              Filename: {{ firebase.fileToUpload.name }}
            </div>
            <ng-template #NoSelect>
              Choose File
            </ng-template>
            <input (change)="firebase.handleFileInput($event)" accept="image/*" autocomplete="off" class="form-control" formControlName="avatarUrl"
                   id="avatar"
                   type="file"
            />
          </label>

          <div *ngIf="firebase.percentage | async as pct">
            <!--  <mat-progress-bar mode="determinate" [value]="pct"></mat-progress-bar>-->
            <div class="col-12">
              <div class="progress">
                <div [ngStyle]="{ width: pct + '%' }" aria-valuemax="100"
                     aria-valuemin="0" aria-valuenow="{{ pct | number }}" class="progress-bar progress-bar-info progress-bar-striped"
                     role="progressbar"> {{ pct | number }}%
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="firebase.fb as url">
            <img [src]="firebase.fb" class="img-thumbnail img-fluid" style="width: 120px; height: 120px;"><br>
          </div>

          <div *ngIf="createMusicForm.get('avatarUrl').invalid && createMusicForm.get('avatarUrl').touched"
               style="color: #ff0000">
            Avatar is <strong>required</strong>.
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <p></p>
      </div>


    </div>

    <div class="row">

      <div class="col-md-4">
        <p></p>
      </div>
      <div class="col-md-2">
        <div class="form-group">
          <label><strong>Mp3 file: </strong> </label> &nbsp;
          <label class="label-input" for="mp3Url">
            <div *ngIf="firebaseMP3.fileToUpload; else NoSelect">
              Filename: {{ firebaseMP3.fileToUpload.name }}
            </div>
            <ng-template #NoSelect>
              Choose File
            </ng-template>
            <input (change)="firebaseMP3.handleFileInput($event)" accept="audio/*" autocomplete="off" class="form-control" formControlName="mp3Url"
                   id="mp3Url"
                   type="file"
            />
          </label>

          <div *ngIf="firebaseMP3.percentage | async as pct">
            <!--  <mat-progress-bar mode="determinate" [value]="pct"></mat-progress-bar>-->
            <div class="col-12">
              <div class="progress">
                <div [ngStyle]="{ width: pct + '%' }" aria-valuemax="100"
                     aria-valuemin="0" aria-valuenow="{{ pct | number }}" class="progress-bar progress-bar-info progress-bar-striped"
                     role="progressbar"> {{ pct | number }}%
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="firebaseMP3.fb as urlMp3">
            <audio class="playlist" controls="controls" id="audio" style="width:100%">
              <source src="{{ urlMp3 }}" type="audio/mpeg">
            </audio>
          </div>

          <div *ngIf="createMusicForm.get('mp3Url').invalid && createMusicForm.get('mp3Url').touched"
               style="color: #ff0000">
            Mp3 Url is <strong>required</strong>.
          </div>
        </div>
      </div>
      <div class="col-md-2">
        <mat-form-field appearance="fill" class="example-full-width">
          <mat-label><strong style="color: darkgray;">Author: </strong></mat-label>
          <input type="text" matInput formControlName="author">
          <mat-error
            *ngIf="createMusicForm.get('author').invalid && createMusicForm.get('author').touched">
            Author is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </div>
      <div class="col-md-4">
        <p></p>
      </div>


    </div>

    <div class="row">

      <div class="col-md-4">
        <p></p>
      </div>
      <div class="col-md-2">
        <mat-form-field appearance="fill" class="example-full-width">
          <mat-label><strong style="color: darkgray;">Views: </strong></mat-label>
          <input type="number" matInput formControlName="views">
          <mat-error
            *ngIf="createMusicForm.get('views').invalid && createMusicForm.get('views').touched">
            Views is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </div>
      <div class="col-md-2">
        <mat-form-field appearance="fill" class="example-full-width">
          <mat-label><strong style="color: darkgray;">Singer: </strong></mat-label>
          <mat-select formControlName="singer_id" multiple>
            <mat-option *ngFor="let singer of singers" [value]="singer.id">{{ singer.singer_name }}</mat-option>
          </mat-select>
          <mat-error *ngIf="createMusicForm.get('singer_id').invalid && createMusicForm.get('singer_id').touched" style="color: #ff0000">
            Singer is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </div>
      <div class="col-md-4">
        <p></p>
      </div>


    </div>

    <div class="row">

      <div class="col-md-4">
        <p></p>
      </div>
      <div class="col-md-2">
        <mat-form-field appearance="fill" class="example-full-width">
          <mat-label><strong style="color: darkgray;">Category: </strong></mat-label>
          <mat-select formControlName="category_id">
            <mat-option *ngFor="let category of categories" [value]="category.id">{{ category.category_name }}</mat-option>
          </mat-select>
          <mat-error *ngIf="createMusicForm.get('category_id').invalid && createMusicForm.get('category_id').touched" style="color: #ff0000">
            Category is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </div>
      <div class="col-md-2">
        <mat-form-field appearance="fill" class="example-full-width">
          <mat-label><strong style="color: darkgray;">Album: </strong></mat-label>
          <mat-select formControlName="album_id">
            <mat-option *ngFor="let album of albums" [value]="album.id">{{ album.album_name }}</mat-option>
          </mat-select>
          <mat-error *ngIf="createMusicForm.get('album_id').invalid && createMusicForm.get('album_id').touched" style="color: #ff0000">
            Album is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </div>
      <div class="col-md-4">
        <p></p>
      </div>


    </div>

    <div class="row">
      <div class="col-md-4">
        <p></p>
      </div>
      <div align="center" class="col-md-4" style="text-align: center">
        <mat-form-field appearance="fill" class="example-full-width">
          <mat-label><strong style="color: darkgray;">Describes: </strong></mat-label>
          <textarea matInput formControlName="describes"></textarea>
          <mat-error
            *ngIf="createMusicForm.get('describes').invalid && createMusicForm.get('describes').touched">
            Describes is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </div>
      <div class="col-md-4">
        <p></p>
      </div>

    </div>

    <div class="row">

      <div class="col-md-4">
        <p></p>
      </div>
      <div style="text-align: center" class="col-md-4">
        <button [disabled]="!createMusicForm.valid" class="btn btn-primary" type="submit">Thêm Bài Hát</button>
      </div>
      <div class="col-md-4">
        <p></p>
      </div>


    </div>
  </form>
</div>
